/* ============================================================
   SyncPilot Investigative Dossier — Shared Stylesheet
   FT Colour Palette · Source Serif / Source Sans Typography
   ============================================================ */

/* --- Google Fonts --- */
@import url('https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,300;0,8..60,400;0,8..60,600;0,8..60,700;1,8..60,400&family=Source+Sans+3:ital,wght@0,300;0,400;0,600;0,700;1,400&display=swap');

/* --- CSS Custom Properties (FT Palette) --- */
:root {
  /* Core palette */
  --paper:    #FFF1E5;
  --claret:   #990F3D;
  --oxford:   #0D7680;
  --teal:     #0D7680;
  --wheat:    #F2DFCE;
  --sky:      #CCE6FF;
  --slate:    #262A33;
  --mango:    #FF8833;
  --mandarin: #FF7FAA;
  --lemon:    #FFEC1A;

  /* Functional aliases */
  --bg:              var(--paper);
  --text:            var(--slate);
  --heading-primary: var(--claret);
  --heading-secondary: var(--oxford);
  --link:            var(--oxford);
  --link-hover:      var(--claret);
  --card-bg:         var(--wheat);
  --info-bg:         var(--sky);
  --warning:         var(--mango);
  --danger:          var(--mandarin);
  --highlight:       var(--lemon);

  /* Risk tiers */
  --risk-high:   #CC0033;
  --risk-medium: var(--mango);
  --risk-low:    #0A7D3F;

  /* Typography */
  --font-body: 'Source Serif 4', 'Georgia', serif;
  --font-ui:   'Source Sans 3', 'Helvetica Neue', sans-serif;

  /* Spacing scale (4px base) */
  --sp-1: 0.25rem;
  --sp-2: 0.5rem;
  --sp-3: 0.75rem;
  --sp-4: 1rem;
  --sp-6: 1.5rem;
  --sp-8: 2rem;
  --sp-12: 3rem;
  --sp-16: 4rem;

  /* Layout */
  --max-width: 1140px;
  --nav-height: 56px;
  --sidebar-width: 280px;
}

/* --- Reset & Base --- */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

html {
  font-size: 16px;
  scroll-behavior: smooth;
  -webkit-text-size-adjust: 100%;
}

body {
  font-family: var(--font-body);
  color: var(--text);
  background: var(--bg);
  line-height: 1.65;
  min-height: 100vh;
  padding-top: var(--nav-height);
}

/* --- Typography --- */
h1, h2, h3, h4 {
  font-family: var(--font-body);
  font-weight: 700;
  line-height: 1.2;
  letter-spacing: -0.01em;
}

h1 {
  font-size: clamp(1.75rem, 4vw, 2.5rem);
  color: var(--heading-primary);
  margin-bottom: var(--sp-6);
}

h2 {
  font-size: clamp(1.35rem, 3vw, 1.75rem);
  color: var(--heading-secondary);
  margin-top: var(--sp-12);
  margin-bottom: var(--sp-4);
  padding-bottom: var(--sp-2);
  border-bottom: 1px solid var(--wheat);
}

h3 {
  font-size: clamp(1.1rem, 2.5vw, 1.35rem);
  color: var(--heading-primary);
  margin-top: var(--sp-8);
  margin-bottom: var(--sp-3);
}

h4 {
  font-size: 1rem;
  color: var(--heading-secondary);
  font-family: var(--font-ui);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  margin-top: var(--sp-6);
  margin-bottom: var(--sp-2);
}

p { margin-bottom: var(--sp-4); }

a {
  color: var(--link);
  text-decoration: underline;
  text-decoration-thickness: 1px;
  text-underline-offset: 2px;
  transition: color 0.15s;
}
a:hover { color: var(--link-hover); }

strong { font-weight: 600; }

blockquote {
  border-left: 3px solid var(--claret);
  padding: var(--sp-3) var(--sp-6);
  margin: var(--sp-6) 0;
  background: rgba(242,223,206,0.4);
  font-style: italic;
}

code, pre {
  font-family: 'IBM Plex Mono', 'Consolas', monospace;
  font-size: 0.88rem;
}

pre {
  background: var(--slate);
  color: var(--paper);
  padding: var(--sp-4);
  border-radius: 4px;
  overflow-x: auto;
  margin: var(--sp-4) 0;
}

hr {
  border: none;
  border-top: 1px solid var(--wheat);
  margin: var(--sp-8) 0;
}

/* --- Layout Containers --- */
.container {
  max-width: var(--max-width);
  margin: 0 auto;
  padding: 0 var(--sp-6);
}

.content-area {
  max-width: 780px;
  margin: 0 auto;
  padding: var(--sp-8) var(--sp-6);
}

.full-width {
  max-width: none;
  padding: var(--sp-8) var(--sp-6);
}

/* --- Top Navigation Bar --- */
.site-nav {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: var(--nav-height);
  background: var(--slate);
  color: var(--paper);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 var(--sp-6);
  z-index: 1000;
  box-shadow: 0 1px 4px rgba(0,0,0,0.15);
}

.nav-left {
  display: flex;
  align-items: center;
  gap: var(--sp-4);
}

.nav-right {
  display: flex;
  align-items: center;
  gap: var(--sp-3);
}

/* Hamburger button */
.hamburger {
  background: none;
  border: none;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  gap: 5px;
  padding: 6px;
}
.hamburger span {
  display: block;
  width: 22px;
  height: 2px;
  background: var(--paper);
  transition: transform 0.2s, opacity 0.2s;
}
.hamburger.active span:nth-child(1) { transform: translateY(7px) rotate(45deg); }
.hamburger.active span:nth-child(2) { opacity: 0; }
.hamburger.active span:nth-child(3) { transform: translateY(-7px) rotate(-45deg); }

/* Site title in nav */
.nav-title {
  font-family: var(--font-ui);
  font-size: 0.95rem;
  font-weight: 600;
  color: var(--paper);
  text-decoration: none;
  letter-spacing: 0.02em;
}
.nav-title:hover { color: var(--wheat); }

/* Language toggle */
.lang-toggle {
  font-family: var(--font-ui);
  font-size: 0.8rem;
  font-weight: 600;
  background: transparent;
  color: var(--paper);
  border: 1px solid rgba(255,241,229,0.4);
  border-radius: 3px;
  padding: 4px 10px;
  cursor: pointer;
  letter-spacing: 0.04em;
  transition: background 0.15s, border-color 0.15s;
}
.lang-toggle:hover {
  background: rgba(255,241,229,0.15);
  border-color: var(--paper);
}

/* Search icon button */
.search-btn {
  background: none;
  border: none;
  color: var(--paper);
  cursor: pointer;
  font-size: 1.1rem;
  padding: 6px;
  line-height: 1;
}
.search-btn:hover { color: var(--wheat); }

/* --- Slide-in Side Menu --- */
.side-menu {
  position: fixed;
  top: var(--nav-height);
  left: 0;
  bottom: 0;
  width: var(--sidebar-width);
  background: var(--slate);
  color: var(--paper);
  transform: translateX(-100%);
  transition: transform 0.25s ease;
  z-index: 999;
  overflow-y: auto;
  padding: var(--sp-6) 0;
}
.side-menu.open { transform: translateX(0); }

.side-menu-overlay {
  position: fixed;
  inset: 0;
  top: var(--nav-height);
  background: rgba(0,0,0,0.45);
  z-index: 998;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.25s;
}
.side-menu-overlay.visible {
  opacity: 1;
  pointer-events: auto;
}

.menu-group-label {
  font-family: var(--font-ui);
  font-size: 0.7rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: rgba(255,241,229,0.5);
  padding: var(--sp-4) var(--sp-6) var(--sp-2);
}

.menu-link {
  display: block;
  font-family: var(--font-ui);
  font-size: 0.88rem;
  color: var(--paper);
  text-decoration: none;
  padding: var(--sp-2) var(--sp-6);
  transition: background 0.12s;
  line-height: 1.4;
}
.menu-link:hover {
  background: rgba(255,241,229,0.08);
  color: var(--paper);
}
.menu-link.active {
  border-left: 3px solid var(--claret);
  padding-left: calc(var(--sp-6) - 3px);
  background: rgba(255,241,229,0.05);
}
.menu-link .ch-num {
  display: inline-block;
  width: 26px;
  font-weight: 600;
  color: rgba(255,241,229,0.5);
  font-size: 0.78rem;
}

/* --- Search Overlay --- */
.search-overlay {
  position: fixed;
  inset: 0;
  top: var(--nav-height);
  background: rgba(38,42,51,0.92);
  z-index: 1001;
  display: none;
  justify-content: center;
  padding: var(--sp-8) var(--sp-6);
}
.search-overlay.open { display: flex; }

.search-box {
  width: 100%;
  max-width: 640px;
}

.search-input {
  width: 100%;
  font-family: var(--font-ui);
  font-size: 1.1rem;
  padding: var(--sp-3) var(--sp-4);
  border: 2px solid var(--wheat);
  border-radius: 4px;
  background: var(--paper);
  color: var(--slate);
  outline: none;
}
.search-input:focus { border-color: var(--oxford); }
.search-input::placeholder { color: rgba(38,42,51,0.4); }

.search-results {
  margin-top: var(--sp-4);
  max-height: 60vh;
  overflow-y: auto;
}

.search-result-item {
  display: block;
  background: var(--paper);
  padding: var(--sp-3) var(--sp-4);
  margin-bottom: var(--sp-2);
  border-radius: 4px;
  text-decoration: none;
  transition: background 0.12s;
}
.search-result-item:hover { background: var(--wheat); }
.search-result-item .result-chapter {
  font-family: var(--font-ui);
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  color: var(--claret);
}
.search-result-item .result-text {
  font-size: 0.9rem;
  color: var(--slate);
  margin-top: 2px;
}
.search-result-item mark {
  background: var(--lemon);
  padding: 0 2px;
  border-radius: 2px;
}

.search-no-results {
  color: var(--paper);
  font-family: var(--font-ui);
  text-align: center;
  padding: var(--sp-8);
  opacity: 0.7;
}

/* --- BLUF Summary Box --- */
.bluf {
  border-left: 4px solid var(--claret);
  background: rgba(242,223,206,0.35);
  padding: var(--sp-4) var(--sp-6);
  margin: var(--sp-6) 0;
  font-size: 1.05rem;
  line-height: 1.55;
}
.bluf-label {
  font-family: var(--font-ui);
  font-size: 0.7rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--claret);
  margin-bottom: var(--sp-2);
}

/* --- Info Box --- */
.info-box {
  background: var(--info-bg);
  border-radius: 4px;
  padding: var(--sp-4) var(--sp-6);
  margin: var(--sp-6) 0;
  font-size: 0.95rem;
}
.info-box-label {
  font-family: var(--font-ui);
  font-size: 0.7rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--oxford);
  margin-bottom: var(--sp-2);
}

/* --- Warning Box --- */
.warning-box {
  background: rgba(255,136,51,0.12);
  border-left: 4px solid var(--mango);
  border-radius: 0 4px 4px 0;
  padding: var(--sp-4) var(--sp-6);
  margin: var(--sp-6) 0;
}

/* --- Card Grid --- */
.card-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: var(--sp-6);
  margin: var(--sp-6) 0;
}

.card {
  background: var(--card-bg);
  border-radius: 6px;
  padding: var(--sp-6);
  position: relative;
  transition: box-shadow 0.15s;
}
.card:hover {
  box-shadow: 0 4px 16px rgba(38,42,51,0.1);
}

.card-header {
  display: flex;
  align-items: flex-start;
  gap: var(--sp-4);
  margin-bottom: var(--sp-4);
}

.card-avatar {
  width: 64px;
  height: 64px;
  border-radius: 50%;
  background: rgba(38,42,51,0.12);
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}
.card-avatar svg {
  width: 36px;
  height: 36px;
  fill: rgba(38,42,51,0.3);
}
.card-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.card-name {
  font-family: var(--font-body);
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--slate);
  line-height: 1.25;
}

.card-subtitle {
  font-family: var(--font-ui);
  font-size: 0.8rem;
  color: rgba(38,42,51,0.6);
  margin-top: 2px;
}

.card-meta {
  font-family: var(--font-ui);
  font-size: 0.82rem;
  color: rgba(38,42,51,0.65);
  line-height: 1.5;
  margin-bottom: var(--sp-3);
}

.card-section-label {
  font-family: var(--font-ui);
  font-size: 0.68rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--oxford);
  margin-top: var(--sp-3);
  margin-bottom: var(--sp-1);
}

.card-list {
  list-style: none;
  font-family: var(--font-ui);
  font-size: 0.82rem;
  line-height: 1.6;
  color: var(--slate);
}

.card-pct {
  font-family: var(--font-ui);
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--claret);
  line-height: 1;
}
.card-pct-label {
  font-family: var(--font-ui);
  font-size: 0.68rem;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  color: rgba(38,42,51,0.5);
}

/* --- Role Badge Pills --- */
.badge {
  display: inline-block;
  font-family: var(--font-ui);
  font-size: 0.68rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  padding: 2px 8px;
  border-radius: 3px;
  margin-right: 4px;
  margin-bottom: 4px;
}
.badge-ceo     { background: var(--claret);  color: #fff; }
.badge-dir     { background: var(--oxford);  color: #fff; }
.badge-sh      { background: var(--wheat);   color: var(--slate); }
.badge-md      { background: var(--slate);   color: var(--paper); }
.badge-intermed { background: var(--mango);  color: #fff; }

/* --- Traffic Light Indicators --- */
.risk-indicator {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-family: var(--font-ui);
  font-size: 0.78rem;
  font-weight: 600;
}
.risk-dot {
  width: 12px;
  height: 12px;
  border-radius: 50%;
}
.risk-high   .risk-dot { background: var(--risk-high); }
.risk-medium .risk-dot { background: var(--risk-medium); }
.risk-low    .risk-dot { background: var(--risk-low); }
.risk-high   { color: var(--risk-high); }
.risk-medium { color: var(--risk-medium); }
.risk-low    { color: var(--risk-low); }

/* --- Chart Containers --- */
.chart-container {
  position: relative;
  width: 100%;
  margin: var(--sp-6) 0;
  background: #fff;
  border-radius: 6px;
  padding: var(--sp-4);
  box-shadow: 0 1px 4px rgba(38,42,51,0.06);
}

.chart-title {
  font-family: var(--font-ui);
  font-size: 0.88rem;
  font-weight: 700;
  color: var(--slate);
  margin-bottom: var(--sp-3);
}

.chart-subtitle {
  font-family: var(--font-ui);
  font-size: 0.75rem;
  color: rgba(38,42,51,0.55);
  margin-top: -8px;
  margin-bottom: var(--sp-3);
}

.chart-canvas-wrap {
  position: relative;
  width: 100%;
}

.chart-source {
  font-family: var(--font-ui);
  font-size: 0.68rem;
  color: rgba(38,42,51,0.45);
  margin-top: var(--sp-2);
  text-align: right;
}

/* --- Tables --- */
table {
  width: 100%;
  border-collapse: collapse;
  margin: var(--sp-4) 0;
  font-family: var(--font-ui);
  font-size: 0.88rem;
}

thead th {
  background: var(--wheat);
  text-align: left;
  padding: var(--sp-2) var(--sp-3);
  font-weight: 600;
  font-size: 0.78rem;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  border-bottom: 2px solid rgba(38,42,51,0.15);
}

tbody td {
  padding: var(--sp-2) var(--sp-3);
  border-bottom: 1px solid rgba(242,223,206,0.6);
  vertical-align: top;
}

tbody tr:hover { background: rgba(242,223,206,0.3); }

/* --- Accordion / Expandable Sections --- */
.accordion {
  border: 1px solid var(--wheat);
  border-radius: 4px;
  margin: var(--sp-4) 0;
}
.accordion-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--sp-3) var(--sp-4);
  cursor: pointer;
  font-family: var(--font-ui);
  font-weight: 600;
  font-size: 0.9rem;
  background: rgba(242,223,206,0.25);
  user-select: none;
}
.accordion-header::after {
  content: '▸';
  transition: transform 0.2s;
}
.accordion.open .accordion-header::after { transform: rotate(90deg); }
.accordion-body {
  display: none;
  padding: var(--sp-4);
}
.accordion.open .accordion-body { display: block; }

/* --- Chapter Navigation (Prev/Next) --- */
.chapter-nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--sp-6) 0;
  margin-top: var(--sp-8);
  border-top: 1px solid var(--wheat);
  font-family: var(--font-ui);
}
.chapter-nav a {
  font-size: 0.88rem;
  font-weight: 600;
  text-decoration: none;
}
.chapter-nav .prev::before { content: '← '; }
.chapter-nav .next::after  { content: ' →'; }

/* --- Footer --- */
.site-footer {
  background: var(--slate);
  color: rgba(255,241,229,0.7);
  padding: var(--sp-8) var(--sp-6);
  margin-top: var(--sp-16);
  font-family: var(--font-ui);
  font-size: 0.78rem;
  line-height: 1.6;
}
.footer-inner {
  max-width: var(--max-width);
  margin: 0 auto;
}
.footer-disclaimer {
  max-width: 700px;
  margin-bottom: var(--sp-4);
}
.footer-meta {
  display: flex;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: var(--sp-4);
  padding-top: var(--sp-4);
  border-top: 1px solid rgba(255,241,229,0.15);
  font-size: 0.72rem;
  color: rgba(255,241,229,0.45);
}

/* --- Index / TOC Styles --- */
.toc-section {
  margin: var(--sp-8) 0;
}
.toc-section-title {
  font-family: var(--font-ui);
  font-size: 0.72rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--oxford);
  margin-bottom: var(--sp-3);
  padding-bottom: var(--sp-2);
  border-bottom: 2px solid var(--oxford);
}
.toc-list {
  list-style: none;
}
.toc-item {
  padding: var(--sp-3) 0;
  border-bottom: 1px solid rgba(242,223,206,0.5);
}
.toc-item a {
  display: flex;
  align-items: baseline;
  gap: var(--sp-3);
  text-decoration: none;
  transition: color 0.12s;
}
.toc-item a:hover { color: var(--claret); }
.toc-ch-num {
  font-family: var(--font-ui);
  font-size: 0.78rem;
  font-weight: 700;
  color: var(--claret);
  min-width: 28px;
}
.toc-ch-title {
  font-family: var(--font-body);
  font-size: 1.05rem;
  font-weight: 600;
  color: var(--slate);
}
.toc-ch-desc {
  font-family: var(--font-ui);
  font-size: 0.82rem;
  color: rgba(38,42,51,0.55);
  margin-top: 2px;
}

/* --- Hero / Index Heading --- */
.hero {
  text-align: center;
  padding: var(--sp-12) var(--sp-6) var(--sp-8);
  max-width: 720px;
  margin: 0 auto;
}
.hero h1 {
  font-size: clamp(2rem, 5vw, 3rem);
  margin-bottom: var(--sp-4);
}
.hero-rule {
  width: 64px;
  height: 3px;
  background: var(--claret);
  margin: var(--sp-4) auto;
  border: none;
}
.hero-subtitle {
  font-family: var(--font-ui);
  font-size: 1rem;
  color: rgba(38,42,51,0.6);
  line-height: 1.5;
}

/* --- Language Toggle Content --- */
[data-lang-de] { display: none; }
[data-lang-en] { display: unset; }
body.lang-de [data-lang-de] { display: unset; }
body.lang-de [data-lang-en] { display: none; }

/* Block-level language toggling */
div[data-lang-de], p[data-lang-de], section[data-lang-de],
li[data-lang-de], span[data-lang-de], h1[data-lang-de],
h2[data-lang-de], h3[data-lang-de], h4[data-lang-de],
tr[data-lang-de], td[data-lang-de], th[data-lang-de] { display: none; }

div[data-lang-en], p[data-lang-en], section[data-lang-en],
li[data-lang-en], span[data-lang-en], h1[data-lang-en],
h2[data-lang-en], h3[data-lang-en], h4[data-lang-en],
tr[data-lang-en], td[data-lang-en], th[data-lang-en] { display: unset; }

body.lang-de div[data-lang-de], body.lang-de p[data-lang-de],
body.lang-de section[data-lang-de], body.lang-de li[data-lang-de],
body.lang-de span[data-lang-de], body.lang-de h1[data-lang-de],
body.lang-de h2[data-lang-de], body.lang-de h3[data-lang-de],
body.lang-de h4[data-lang-de], body.lang-de tr[data-lang-de],
body.lang-de td[data-lang-de], body.lang-de th[data-lang-de] { display: unset; }

body.lang-de div[data-lang-en], body.lang-de p[data-lang-en],
body.lang-de section[data-lang-en], body.lang-de li[data-lang-en],
body.lang-de span[data-lang-en], body.lang-de h1[data-lang-en],
body.lang-de h2[data-lang-en], body.lang-de h3[data-lang-en],
body.lang-de h4[data-lang-en], body.lang-de tr[data-lang-en],
body.lang-de td[data-lang-en], body.lang-de th[data-lang-en] { display: none; }

/* --- Responsive --- */

/* Tablet */
@media (max-width: 1024px) {
  .card-grid {
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  }
}

/* Mobile */
@media (max-width: 768px) {
  :root { --nav-height: 50px; }

  .container, .content-area, .full-width {
    padding-left: var(--sp-4);
    padding-right: var(--sp-4);
  }

  .card-grid {
    grid-template-columns: 1fr;
  }

  .chapter-nav {
    flex-direction: column;
    gap: var(--sp-4);
    text-align: center;
  }

  .hero { padding: var(--sp-8) var(--sp-4) var(--sp-6); }

  .footer-meta { flex-direction: column; }

  table { font-size: 0.82rem; }
  thead th, tbody td { padding: var(--sp-2); }
}

/* Small mobile */
@media (max-width: 375px) {
  .card { padding: var(--sp-4); }
  .bluf { padding: var(--sp-3) var(--sp-4); }
}

/* --- Print --- */
@media print {
  body { padding-top: 0; background: #fff; color: #000; font-size: 11pt; }
  .site-nav, .side-menu, .side-menu-overlay,
  .search-overlay, .hamburger, .lang-toggle,
  .search-btn, .chapter-nav { display: none !important; }

  .bluf { border-left-color: #000; background: #f5f5f5; }
  .card { break-inside: avoid; border: 1px solid #ccc; }
  .chart-container { break-inside: avoid; }

  a { color: #000; text-decoration: underline; }
  a[href]::after { content: " (" attr(href) ")"; font-size: 0.8em; color: #666; }
  a[href^="#"]::after, a[href^="javascript"]::after { content: ''; }

  .site-footer { background: #fff; color: #333; border-top: 2px solid #000; }
}
